
Please proceed with the following task:

**Task: Implement "Dynamic Promotion" logic for DirectInput Device Recovery**

**Reference Documents:**
*   `docs\dev_docs\Force Feedback Issues - App Focus.md` (Contains the detailed analysis and specific code snippets to implement)

**Context:**
Users report that Force Feedback stops working when the application loses focus (Alt-Tab) or when the game (Le Mans Ultimate) steals the device priority. The current recovery logic gets stuck in "Shared Mode" (Non-Exclusive), where reading inputs works but writing FFB forces fails with `DIERR_NOTEXCLUSIVEACQUIRED`.
We need to implement a "Dynamic Promotion" mechanism that detects this specific error and aggressively attempts to upgrade the connection back to Exclusive Mode.

**Implementation Requirements:**

1.  **`src/DirectInputFFB.h`**:
    *   Add a private member `bool m_isExclusive` to track the current acquisition state.
    *   Add a public getter `bool IsExclusive() const`.

2.  **`src/DirectInputFFB.cpp`**:
    *   **Update `SelectDevice`**: Ensure `m_isExclusive` is correctly set to `true` if `SetCooperativeLevel` succeeds with `DISCL_EXCLUSIVE`, or `false` if it falls back to `DISCL_NONEXCLUSIVE`.
    *   **Update `UpdateForce`**:
        *   Locate the existing recovery logic block (inside the `RECOVERY_COOLDOWN_MS` check).
        *   Implement the **Dynamic Promotion** logic: If the error is `DIERR_NOTEXCLUSIVEACQUIRED`, explicitly call `Unacquire()`, then `SetCooperativeLevel` with `DISCL_EXCLUSIVE | DISCL_BACKGROUND`.
        *   Ensure `m_pEffect->Start(1, 0)` is called immediately after a successful re-acquisition to restart the FFB motor (fixing the "silent wheel" bug).
    *   **Update Linux Mock (`#else` block)**: In the non-Windows implementation of `SelectDevice`, set `m_isExclusive = true` so the GUI logic can be verified on Linux builds.

3.  **`src/GuiLayer.cpp`**:
    *   In `DrawTuningWindow`, add a visual indicator near the device selection controls.
    *   Display "Mode: EXCLUSIVE (Game FFB Blocked)" in Green if `IsExclusive()` is true.
    *   Display "Mode: SHARED (Potential Conflict)" in Yellow if false, with a tooltip warning about potential conflicts.

**Deliverables:**
*   Modified `src/DirectInputFFB.h`
*   Modified `src/DirectInputFFB.cpp`
*   Modified `src/GuiLayer.cpp`
*   Updated `CHANGELOG.md` (Increment version and document the fix)
*   Updated `VERSION` file

**Check-list for completion:**
- [ ] `DirectInputFFB.h`: `IsExclusive()` added.
- [ ] `DirectInputFFB.cpp`: `SelectDevice` tracks exclusivity state.
- [ ] `DirectInputFFB.cpp`: `UpdateForce` implements Dynamic Promotion (Unacquire -> SetCoop -> Acquire) inside the 2s throttle.
- [ ] `DirectInputFFB.cpp`: Motor restart (`Start(1,0)`) implemented on recovery.
- [ ] `DirectInputFFB.cpp`: Linux mock updated to set `m_isExclusive = true`.
- [ ] `GuiLayer.cpp`: UI shows Exclusive/Shared status.
- [ ] `CHANGELOG.md` and `VERSION` updated.
- [ ] Code compiles successfully.